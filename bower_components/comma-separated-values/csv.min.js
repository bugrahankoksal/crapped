!function(){"use strict";var CSV=function(e){var o=function(e){return!(!e||null===e)};return e=o(e)?e:{},this.options={delimiter:o(e.delimiter)?e.delimiter:",",header:o(e.header)?e.header:!1,stream:o(e.stream)?e.stream:void 0,done:o(e.done)?e.done:void 0},this};CSV.format={cast:function(e){e=e.trim();var o=e.toLowerCase();return""===e?void 0:isNaN(Number(e))?"true"===o||"t"===o||"yes"===o||"y"===o?!0:"false"===o||"f"===o||"no"===o||"n"===o?!1:void 0:Number(e)},stringify:function(e){return isNaN(Number(e))?'"'+e.replace(/\"/,'""')+'"':e},encode:function(e){return e.map(CSV.format.stringify).join(",")+"\r\n"}},CSV.prototype.set=function(e,o){return this.options[e]=o,this.options},CSV.prototype.encode=function(e){var o,t,n,r,i,c;return o=[],t=e[0]instanceof Array?"array":"object",r=this.options.header,i=this.options.stream||[].push,c=this.options.done,"object"===t?(n=Object.keys(e[0]),i.call(o,CSV.format.encode(n)),e.forEach(function(e){e=n.map(function(o){return e[o]}),i.call(o,CSV.format.encode(e))})):(r&&r instanceof Array&&i.call(o,CSV.format.encode(r)),e.forEach(function(e){i.call(o,CSV.format.encode(e))})),c?c(o):o.join("")},CSV.prototype.parse=function(e){var o,t,n,r,i,c,a,s,l;if(o=[],t=this.options.stream||[].push,n=this.options.done,r=this.options.header,i=r instanceof Array?r:[],c={row:[],cell:""},a={escaped:!1,quote:!1,cell:!0},s=function(e){a.escaped&&(e=e.slice(1,-1).replace(/""/g,'"')),c.row.push(CSV.format.cast(e)),c.cell="",a={escaped:!1,quote:!1,cell:!0}},i.length){var f;l=function(){f={},i.forEach(function(e,o){f[e]=c.row[o]}),t.call(o,f)}}else if(r){var f;l=function(){i?(f={},i.forEach(function(e,o){f[e]=c.row[o]}),t.call(o,f)):i=c.row}}else l=function(){t.call(o,c.row)};for(var u,d=0,p=0,h=e.length,m=this.options.delimiter.charCodeAt(0);h>=p;++p)u=e.charCodeAt(p),a.cell&&(a.cell=!1,34===u)?a.escaped=!0:a.escaped&&34===u?a.quote=!a.quote:(a.escaped&&a.quote||!a.escaped)&&(u===m?(s(c.cell+e.slice(d,p)),d=p+1):(10===u||p===h)&&(s((c.cell+e.slice(d,p)).slice(0,-1)),d=p+1,l()));return n?n(o):o},"function"==typeof define&&define.amd?define(CSV):"object"==typeof module&&module.exports?module.exports=CSV:window.CSV=CSV}();